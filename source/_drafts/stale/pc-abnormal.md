---
title: "一次诡异的电脑异常"
date: 2020-04-06T00:09:08+08:00
tags: ["电脑","异常","系统","主板","BIOS","显卡","内存"]
draft: true 

---

# 状况描述

最近电脑遇到了一连串诡异的问题，用电脑十几年，头一次遇到这种这种问题，简直就是知识盲区，差点自闭了。

最近开始折腾 `Istio`，环境大概是 `Istio over Kubenetes over CentOS7 over VMWare over Windows 10`，然后就开始出现异常了，如果我没记错的话，异常情况应该是在安装 `Istio` 后开始的，这听起来很奇怪。

大致有以下症状：

1. 主板是一张 `Z370-M`，BIOS 界面一用鼠标就会卡死，这个问题存在一两年了，对使用没啥影响。
1. 显卡是一张`RX570 二手矿卡`，有时候开机屏幕不显示，但系统已正常启动，且有时候出现掉驱动的情况。
1. 玩`英雄联盟`无限崩溃，重复崩溃多次后直接蓝屏，再后面甚至都不蓝屏了，直接卡死或者重启。
1. 卸载显卡驱动失败，安装显卡驱动失败，且可能导致电脑蓝屏，甚至直接卡死或者重启。
1. `VMWare` 虚拟机跑着跑着就会出现`客户机操作系统已禁用cpu。请关闭或重置虚拟机。`，关掉再开机会自动进入 `emergency mode`，检查了一下，发现 `/etc/fstab` 文件丢失，且 `fdisk` 等磁盘工具都找不到，暂时想不到什么方法找到磁盘 `UUID`，虚拟机实例算坏掉了。 
1. 经过多次死机后，BIOS 引导顺序会失效，设置后过不了多久又会失效。
1. `Windows` dump 文件为空。
1. 鲁大师可以识别出显卡，但是读取不到显卡温度。

# 排查思路

遇到上面一连串的问题后，我开始排查问题，期间遇到了一些与预期不符合的情况，开始陷入自闭。

### 重新安装虚拟机

由于是开始折腾 Istio 后才出现的问题，是我安装的姿势不对吗？虽然整个虚拟环境都是全新安装的，不过我还是重装了一次，结果是每次 Istio 安装完成后不久，就会开始出现 `客户机操作系统已禁用cpu。请关闭或重置虚拟机。`的提示，随后虚拟机坏掉，虽然可以重现问题，但我认为问题不在 `Istio`、`Kubernetes`、`CentOS` 或 `VMWare` 上面。

### windows dump

windows 系统在蓝屏时，一般会自动记录一份 dump 文件，以便分析问题，其路径是 `%SystemRoot%\Minidump`，然而，我的电脑上并没有相关文件，只得手动排查。

### 内存

虽然我首先想到可能是显卡的问题，不过我还是选择先排查一下内存的问题，我的内存是 `2400 MHz 16G x 4`。

第一步，猜测是不是这垃圾内存条体质太差了，它连默认的 `2400 MHz` 都稳不住吗？进入 BIOS 将频率降至 `2133 MHz`，开机，进游戏，崩溃。

第二步，测试内存稳定性，下载软件 `MemTest`，点击 `Begin Test`，随后电脑直接死机，不愧是我，这么轻松的就找到了问题所在。（然而自闭才刚刚开始）

第三步，上面 `MemTest` 一启动就死机，猜测是某根内存条出现了问题。随即拆掉三根内存条，只留一根内存条，开机，`MemTest`、游戏，大乱斗，没有问题，下一根内存条，随后依次换了其它三根内存条，结果都没有问题……

第四步，我使用的是同一品牌、型号的四根内存条，难道是出现了兼容性问题？这垃圾内存条，我尝试再次将四根内存条同时插上，再次 `MemTest`，结果这次没有出现问题。

第五步，用 windows 自带的内存测试工具，会重启电脑并开始测试，看起来测试很全面，全程大概需两三个小时，最终结果是，`内存没有任何问题`，该死的，冤枉内存君了吗，白折腾几个小时……

### 显卡

第一个想到的就是显卡问题，早就看这张亮机卡不爽了，并且确实存在有时候点不亮，掉驱动的问题，所以连夜在狗东下单了一张 `RX 5700`（花两千多就多了个 0……）。

第一步，开箱、装机、点亮。由于开机没有提示需要安装驱动，且能正确识别显卡，遂没有重新安装显卡驱动。

第二步，测试，重现虚拟机环境（这次做了快照）和游戏环境，心想，钱也花了，显卡也换了，这次该没问题了吧。然而，现实总是这么的无情，再次出现死机的情况，开始持续自闭了。

第三步，一定是因为我没有为 `RX 5700` 安装显卡驱动的原因，看样子不能偷懒了，准备清洁安装一次驱动（即先卸载并清理当前驱动，再安装新驱动）。然而，在卸载驱动时，电脑就直接死机了……

第四步，既然卸载驱动未遂，那就直接装吧，心想总比没装好，然而，在安装驱动的时候就开始报错了，提示无法完成驱动安装……

### 重装系统

新买的显卡大概率没有问题，内存也通过了测试，难道是现在的系统出现了问题？本想等待 `Windows 10 2004` 发布后重装系统的，现在看来不得不提前了。

第一步，重装系统，我的系统盘是一块单独的固态硬盘，直接全盘格式化并分区，安装系统，轻车熟路完成安装。

第二步，安装驱动，显卡驱动。在这个全新安装的操作系统里，为全新的显卡安装最新的驱动，为了不让我失望，它又直接死机了……，重启后再次尝试安装驱动，总是是装上了，虽然 AMD 那个 Dashboard 打不开。

第三步，这一定是个意外，这怎么可能出问题呢，不死心的我又安装了一次 `Istio` 的环境，事实证明，不行就是不行，该死机还得死机。

### 剩余的可能性

自此，我又陷入了的自闭，看样子跟 `内存`、`显卡`、`系统`都没有关系。

除此之外，还有哪些可能？似乎只有 `CPU`、`主板`、`硬盘`没有排查了。

`CPU` 坏掉的可能性基本可以排除，除了被我掰断针脚的 AMD 的 CPU，我就没见过坏掉的 CPU。

`硬盘` 我装了三块硬盘，除了这块 `250 GB` 的系统盘，其它两块硬盘都放了很多数据，多且杂，迁移数据太麻烦了。并且，我也从没见过坏掉的硬盘，家里那台 `12 年` 前的主机上使用的 `易拓 250 GB 机械硬盘`至今还可以正常使用。

`主板` 主板坏掉的可能性是存在的，并且我遇到过，所以，我倾向于先看看主板的问题。

### 主板

主板一直都存在一个图形 BIOS 异常的问题（用鼠标就会导致 BIOS 卡死），并且现在出现了引导顺序失效的问题。所以猜测主板有问题也算合理。

但是主板排查很麻烦，手里只有一个主机，没有多余的主板可以替换测试，即使有，拆机装机也挺麻烦的。即使最终确定了是主板的问题，送往京东返修，主板的话，一般需要 1-4 周，太费时间了。

我陷入了深深的自闭，我好难啊……

不过，我突然想到可不可以更新一下 BIOS 固件，这或许可以解决主板固件方面的问题。

我使用的是主板是 `华擎 Z370M Pro4`，这块主板可以在 BIOS 里直接联网更新 BIOS，还是挺方便的。下载好固件后，会提示要求插入一个优盘，然后确定并重启，会自动完成 BIOS 升级。

幸好我的 BIOS 很久没有更新了，有新版本可以直接升级，否则还得去官方手动下载固件并升级。

升级过程很顺利，看起来我只需要保证不断电就行了，华擎居然可以自己完成升级。

完成后，进入 BIOS，首先用测试了一下，用鼠标点击居然不会出现卡死的情况了！！！看样子升级固件确实修复了一些问题。

设置引导顺序，重启，进入系统。

重现 `Istio` 环境，没有问题！！！

同时再开一把`极地大乱斗`，没有问题！！！

同时再打开 `IG vs RNG 的春晚现场`，没有问题！！！

再打开鲁大师检测温度，正确读取到显卡问题！！！

看起来引起这一系列问题的罪魁祸首就是主板了！自此，问题似乎得到了解决，没有再出现什么严重的异常问题了，折磨了我一个清明节，淦。

虽不清楚具体原因，但华擎的售后也不一定懂。事实上，我遇到过的坏掉的主板也是`华擎`的主板，并且也是`我自己使用的`。它，就是我的上一台主机，一块 `华擎 B85M Pro4`，当时的情况是直接开不了机，问题很明显，走京东售后，结果售后直接联系我，由于主板已停产，要把当初买主板的钱退给我，让我自己买一块新主板（狗东售后还是可以的）。

# 总结

下次装机买块好主板（如果有钱的话）。

装机十几年，一直认为主板这个东西，够用就行，注意一下板型（ATX、M-ATX、ITX）和接口（CPU、PCI-E、DDR3/4、M.2、USB），选择性价比高的就可以了。`华擎` 的主板看起来有着不错的性价比，并且和 `华硕` 存在着某种联系，让人觉得它的品质不会太差。所以我不管是帮别人组装电脑，还是自己组装，都很喜欢买 `华擎` 的主板。然而，我在 4 年之内已经用坏（异常）两块华擎的主板了，`华擎`牛逼！！！

当然，这可能也和使用方式及概率有关，我帮别人组装的电脑似乎都没有遇到过这个问题。而我，除了时不时拆装机清清灰，还把这个主板向刺猬一样插满了（一块显卡、一块 PCI-E 硬盘、一块 M.2 硬盘、一块机械硬盘、三个机箱风扇、四根内存条），或许这让它不堪重负吧。
